package browserpicker.data.local.repository

import androidx.paging.PagingConfig
import androidx.paging.PagingData
import browserpicker.core.di.InstantProvider
import browserpicker.core.di.IoDispatcher
import browserpicker.core.results.AppError
import browserpicker.core.results.MyResult
import browserpicker.core.results.UriValidationError
import browserpicker.data.local.datasource.UriHistoryLocalDataSource
import browserpicker.data.local.query.model.UriRecordQueryConfig
import browserpicker.domain.model.DateCount
import browserpicker.domain.model.GroupCount
import browserpicker.domain.model.InteractionAction
import browserpicker.domain.model.UriRecord
import browserpicker.domain.model.UriSource
import browserpicker.domain.model.query.UriHistoryQuery
import browserpicker.domain.repository.UriHistoryRepository
import browserpicker.domain.service.UriParser
import kotlinx.coroutines.CoroutineDispatcher
import kotlinx.coroutines.flow.Flow
import kotlinx.coroutines.flow.catch
import kotlinx.coroutines.flow.flowOf
import kotlinx.coroutines.flow.flowOn
import kotlinx.coroutines.flow.map
import kotlinx.coroutines.withContext
import timber.log.Timber
import javax.inject.Inject
import javax.inject.Singleton
import androidx.paging.map
import androidx.room.withTransaction
import browserpicker.data.local.mapper.UriRecordMapper
import browserpicker.domain.*
import kotlinx.coroutines.flow.firstOrNull
